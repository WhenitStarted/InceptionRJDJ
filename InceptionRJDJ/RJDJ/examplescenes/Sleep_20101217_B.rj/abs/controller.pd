#N canvas 171 64 885 628 10;
#X obj 542 79 r #rjdj_architect_in;
#N canvas 89 83 999 576 APP_EJECT 0;
#X text 630 363 app is sent 'scene_eject_end' after fading out;
#X obj 497 274 s \$1-IO-mainmix_vol;
#X text 624 93 SCENE_EJECT;
#X text 647 274 fade down main mix;
#X msg 474 344 symbol scene_eject_end;
#X text 644 344 send 'scene_eject_end' to app;
#X obj 474 136 sel scene_eject_start;
#X text 632 136 when scene receives 'scene_eject_start' from app;
#X text 165 144 SCENE_IDLE;
#X obj 37 494 s \$1-IO-mainmix_vol;
#X obj 37 192 sel scene_idle;
#X text 181 494 dip main mix volume;
#X text 140 192 when scene receives 'scene_idle' from app;
#X text 42 532 the scene will now wait for the app to send 'scene_eject_start'
;
#X text 74 158 (when app starts progress bar to leave scene);
#X obj 37 51 t a a;
#X text 560 107 (app prepares scene to be shut down);
#X text 307 9 Interaction with native app. Only quits with higher priority
scenes.;
#X text 97 473 level to dip volume to;
#X obj 474 364 outlet architect_out;
#X obj 37 29 inlet architect_in;
#X obj 37 214 t b b;
#X msg 69 244 0;
#X text 112 385 shuts scene's own quit system;
#X obj 474 164 t b b b;
#X msg 520 194 0;
#X text 550 194 shuts scene's own quit system;
#X obj 69 266 t f f f;
#X obj 115 286 s \$1-CONTROLLER-SCENE_EJECT_START_idle_spigot;
#X obj 92 336 s \$1-CONTROLLER-EJECT_START_active_spigot;
#X msg 37 474 0.3 0.2;
#X obj 69 404 s \$1-CONTROLLER-detector_spigot;
#X obj 520 214 s \$1-CONTROLLER-detector_spigot;
#X text 541 325 wait 2 seconds;
#X obj 474 324 del 2000;
#X msg 497 254 0 0.5;
#X connect 4 0 19 0;
#X connect 6 0 24 0;
#X connect 10 0 21 0;
#X connect 15 0 10 0;
#X connect 15 1 6 0;
#X connect 20 0 15 0;
#X connect 21 0 30 0;
#X connect 21 1 22 0;
#X connect 22 0 27 0;
#X connect 24 0 34 0;
#X connect 24 1 35 0;
#X connect 24 2 25 0;
#X connect 25 0 32 0;
#X connect 27 0 31 0;
#X connect 27 1 29 0;
#X connect 27 2 28 0;
#X connect 30 0 9 0;
#X connect 34 0 4 0;
#X connect 35 0 1 0;
#X restore 542 109 pd APP_EJECT;
#X obj 44 185 cnv 15 134 26 empty empty empty 20 12 0 14 -203904 -66577
0;
#X obj 49 99 r #rjdj_detector_in;
#X obj 344 583 s #rjdj_architect_out;
#X text 580 24 APP EJECTS;
#X text 78 33 SCENE EJECTS;
#X text 634 109 idle/eject process;
#X obj 344 525 r \$1-CONTROLLER-architect_out;
#N canvas 539 411 741 334 app_connection 0;
#X text 87 19 Connection to app;
#X obj 65 44 inlet CONTROLLER-architect_out;
#X obj 65 286 outlet;
#X text 178 116 Method to circumvent issue with sending symbols and
floats in the same message for scene_idle only.;
#X obj 65 120 sel scene_idle;
#X obj 65 85 schange scene_active;
#X text 129 230 send 'scene_idle 10' to app \, 10 secs until scene_eject_start
;
#X msg 65 230 \$1 \$2 \$3;
#X msg 65 150 scene_idle;
#X obj 65 210 pack s 10 s;
#X obj 139 190 r \$1-CONTROLLER-OR-eventvalue;
#X connect 1 0 5 0;
#X connect 4 0 8 0;
#X connect 4 1 2 0;
#X connect 5 0 4 0;
#X connect 7 0 2 0;
#X connect 8 0 9 0;
#X connect 9 0 7 0;
#X connect 10 0 9 2;
#X restore 344 553 pd app_connection;
#X obj 49 269 t f f;
#N canvas 240 244 649 529 SCENE_ACTIVE 0;
#X obj 83 102 spigot 1;
#X text 270 263 send 'scene_active' to app;
#X msg 115 264 symbol scene_active;
#X obj 136 82 r \$1-CONTROLLER-EJECT_START_active_spigot;
#X obj 115 284 s \$1-CONTROLLER-architect_out;
#X obj 83 48 inlet DETECTOR;
#X obj 83 194 sel 0;
#X obj 129 374 s \$1-CONTROLLER-ACTIVE-del_cancel;
#X obj 106 414 s \$1-CONTROLLER-IDLE-fade_del_cancel;
#X obj 83 485 s \$1-IO-mainmix_vol;
#X obj 83 244 t b b;
#X obj 83 344 t b b b;
#X text 366 414 cancels delay if scene_active;
#X text 370 372 cancels fade if scene_active;
#X text 225 485 fade up mainmix;
#X msg 83 464 1 2;
#X text 116 464 500 ms;
#X connect 0 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 0 1;
#X connect 5 0 0 0;
#X connect 6 0 10 0;
#X connect 10 0 11 0;
#X connect 10 1 2 0;
#X connect 11 0 15 0;
#X connect 11 1 8 0;
#X connect 11 2 7 0;
#X connect 15 0 9 0;
#X restore 81 299 pd SCENE_ACTIVE;
#N canvas 450 183 715 513 SCENE_EJECT_START 0;
#X obj 60 376 s \$1-IO-mainmix_vol;
#X msg 72 103 symbol scene_eject_start;
#X text 252 103 send 'scene_eject_start' to app;
#X text 200 376 fade down main mix;
#X msg 80 283 0;
#X obj 40 83 t b b;
#X text 379 306 stop active control after eject start;
#X msg 100 210 0;
#X text 424 234 stop idle control after eject start;
#X obj 100 233 s \$1-CONTROLLER-SCENE_EJECT_START_idle_spigot;
#X obj 80 306 s \$1-CONTROLLER-EJECT_START_active_spigot;
#X obj 40 456 outlet EJECT_END_bang;
#X obj 40 43 inlet EJECT_START_BANG;
#X obj 72 123 s \$1-CONTROLLER-architect_out;
#X obj 40 170 t b b b b;
#X text 107 436 2 second delay till scene_eject_end;
#X obj 40 436 del 2000;
#X msg 60 356 0 0.5;
#X connect 1 0 13 0;
#X connect 4 0 10 0;
#X connect 5 0 14 0;
#X connect 5 1 1 0;
#X connect 7 0 9 0;
#X connect 12 0 5 0;
#X connect 14 0 16 0;
#X connect 14 1 17 0;
#X connect 14 2 4 0;
#X connect 14 3 7 0;
#X connect 16 0 11 0;
#X connect 17 0 0 0;
#X restore 49 359 pd SCENE_EJECT_START;
#N canvas 310 92 492 157 SCENE_EJECT_END 0;
#X msg 44 66 symbol scene_eject_end;
#X text 208 67 send 'scene_eject_end' to app;
#X obj 44 36 inlet EJECT_END_bang;
#X obj 44 96 outlet \$1-CONTROLLER-architect_out;
#X connect 0 0 3 0;
#X connect 2 0 0 0;
#X restore 49 389 pd SCENE_EJECT_END;
#N canvas 14 388 592 587 SCENE_IDLE 0;
#X msg 60 208 symbol scene_idle;
#X obj 28 528 del 10000;
#X text 101 528 delay for eject_start;
#X obj 48 478 r \$1-CONTROLLER-ACTIVE-del_cancel;
#X obj 28 108 spigot 1;
#X obj 81 88 r \$1-CONTROLLER-SCENE_EJECT_START_idle_spigot;
#X obj 28 548 outlet EJECT_START_bang;
#X obj 60 228 s \$1-CONTROLLER-architect_out;
#X text 191 208 send scene_idle to app;
#X obj 28 48 inlet DETECTOR;
#X obj 28 148 sel 1;
#X obj 60 378 del 1500;
#X msg 60 398 0.3 0.118;
#X obj 60 418 s \$1-IO-mainmix_vol;
#X text 289 478 cancels delay if scene_active;
#X msg 48 498 stop;
#X msg 80 348 stop;
#X text 348 328 cancels fade if scene_active;
#X obj 28 188 t b b;
#X obj 28 278 t b b;
#X obj 80 328 r \$1-CONTROLLER-IDLE-fade_del_cancel;
#X connect 0 0 7 0;
#X connect 1 0 6 0;
#X connect 3 0 15 0;
#X connect 4 0 10 0;
#X connect 5 0 4 1;
#X connect 9 0 4 0;
#X connect 10 0 18 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 15 0 1 0;
#X connect 16 0 11 0;
#X connect 18 0 19 0;
#X connect 18 1 0 0;
#X connect 19 0 1 0;
#X connect 19 1 11 0;
#X connect 20 0 16 0;
#X restore 49 329 pd SCENE_IDLE;
#X obj 542 135 s \$1-CONTROLLER-architect_out;
#X text 33 50 if scene criteria is not met;
#X obj 466 375 cnv 15 212 26 empty empty empty 20 12 0 14 -204786 -66577
0;
#X obj 472 380 controller_scene_specific \$1;
#X obj 49 190 scene_criteria \$1;
#X obj 49 419 s \$1-CONTROLLER-architect_out;
#X text 31 454 ------------------------------------------------------------
;
#X text 451 454 ------------------------------------------------------------
;
#X text 352 495 SCENE --> APP CONNECTION;
#X text 463 352 SCENE SPECIFIC CHANGES GO HERE:;
#X text 183 190 0 for scene_active \, 1 for scene_idle;
#X obj 102 129 r \$1-CONTROLLER-detector_spigot;
#X text 432 43 if user presses 'eject' or higher priority scene available
;
#N canvas 347 173 668 353 SCENE_INFINITY 0;
#X obj 46 25 r #rjdj_architect_in;
#X msg 190 220 scene_init bang;
#X obj 190 240 s #rjdj_detector_out;
#X msg 46 120 0;
#X msg 190 129 1;
#X text 307 220 queries current state from rj_detector;
#X obj 222 180 s \$1-CONTROLLER-detector_spigot;
#X obj 69 270 s \$1-CONTROLLER-infinity_switch;
#X obj 46 141 t b f f;
#X text 295 271 if infinity on - switch to scene_active;
#X obj 46 310 outlet;
#X obj 190 150 t b f;
#X text 203 66 Infinity Switch (decides if scene controls itself or
not);
#X obj 190 86 sel scene_infinity_off;
#X obj 46 56 sel scene_infinity_on;
#X connect 0 0 14 0;
#X connect 1 0 2 0;
#X connect 3 0 8 0;
#X connect 4 0 11 0;
#X connect 8 0 10 0;
#X connect 8 1 7 0;
#X connect 8 2 6 0;
#X connect 11 0 1 0;
#X connect 11 1 6 0;
#X connect 13 0 4 0;
#X connect 14 0 3 0;
#X connect 14 1 13 0;
#X restore 69 231 pd SCENE_INFINITY;
#X obj 49 149 spigot 0;
#X connect 0 0 1 0;
#X connect 1 0 15 0;
#X connect 3 0 29 0;
#X connect 8 0 9 0;
#X connect 9 0 4 0;
#X connect 10 0 14 0;
#X connect 10 1 11 0;
#X connect 12 0 13 0;
#X connect 13 0 20 0;
#X connect 14 0 12 0;
#X connect 19 0 10 0;
#X connect 26 0 29 1;
#X connect 28 0 10 0;
#X connect 29 0 19 0;
